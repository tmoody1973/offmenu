# Off Menu

> Every Meal Has a Story. Find Yours.

An AI-powered culinary storytelling platform that transforms restaurant discovery from transactional search into immersive, narrative-driven journeys.

## Overview

Off Menu is the love child of Anthony Bourdain's storytelling and Alton Brown's food science — an app that doesn't just find restaurants, but creates culinary experiences with soul. We surface not just what to eat, but why it matters.

### Key Features

- **Ask the Butler** - AI concierge powered by Perplexity for natural language food discovery
- **Curated Maps** - Eater-style restaurant guides generated by AI (Best Tacos, Hidden Gems, Date Night, etc.)
- **Three for Tonight** - Weather-aware, time-of-day contextual dinner recommendations
- **Daily Story** - AI-generated restaurant narratives in editorial style
- **Save & Bookmark** - Save restaurants from any source for later
- **Multi-City Support** - Track up to 11 favorite cities like a weather app for food

## Tech Stack

| Layer | Technology |
|-------|------------|
| Frontend | Flutter 3.x (iOS, Android, Web) |
| Backend | Serverpod 2.x (Dart) |
| Database | PostgreSQL |
| AI Research | Perplexity Sonar API |
| Restaurant Data | Google Places API |
| Maps | Google Maps Flutter SDK |
| Auth | Serverpod Auth + Google Sign-In |

## Project Structure

```
offmenu/
├── food_butler_server/     # Serverpod backend
│   ├── lib/src/
│   │   ├── endpoints/      # API endpoints
│   │   ├── services/       # Business logic (Perplexity, Google Places)
│   │   └── protocol/       # Data models (YAML → generated Dart)
│   └── config/             # Environment configs
├── food_butler_flutter/    # Flutter client app
│   ├── lib/
│   │   ├── screens/        # UI screens
│   │   ├── widgets/        # Reusable components
│   │   ├── theme/          # App styling (Eater-inspired)
│   │   └── router/         # GoRouter navigation
│   └── web/                # Web-specific assets
├── food_butler_client/     # Generated API client
├── agent-os/               # Product docs & specs
│   ├── product/            # Mission, roadmap, tech stack
│   └── specs/              # Feature specifications
└── docs/                   # Additional documentation
```

## Quick Start

### Prerequisites

- Flutter SDK 3.x
- Dart SDK 3.x
- Docker (for PostgreSQL)
- API Keys: Google Places, Perplexity

### 1. Clone & Install

```bash
git clone https://github.com/tmoody1973/offmenu.git
cd offmenu
```

### 2. Start Database

```bash
cd food_butler_server
docker compose up -d --build
```

### 3. Configure API Keys

Create `food_butler_server/config/passwords.yaml`:

```yaml
development:
  database: '<your-db-password>'
  serviceSecret: '<generate-a-secret>'

shared:
  PERPLEXITY_API_KEY: '<your-perplexity-key>'
  GOOGLE_PLACES_API_KEY: '<your-google-places-key>'
  GOOGLE_MAPS_API_KEY: '<your-google-maps-key>'
```

### 4. Run Database Migrations

```bash
cd food_butler_server
dart bin/main.dart --apply-migrations
```

### 5. Start the Server

```bash
cd food_butler_server
dart bin/main.dart
```

Server runs on:
- API: http://localhost:8080
- Insights: http://localhost:8081
- Web: http://localhost:8082

### 6. Run Flutter App

```bash
cd food_butler_flutter
flutter pub get
flutter run -d chrome --web-port=3000
```

> **Note:** Port 3000 is required for Google OAuth callback.

## Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `PERPLEXITY_API_KEY` | Perplexity Sonar API for AI research | Yes |
| `GOOGLE_PLACES_API_KEY` | Google Places for restaurant data | Yes |
| `GOOGLE_MAPS_API_KEY` | Google Maps for map display | Yes |
| `WEB_SERVER_PUBLIC_URL` | Public URL for photo proxy | No |

## Development

### Generate Code

After modifying protocol YAML files:

```bash
cd food_butler_server
serverpod generate
```

### Analyze Code

```bash
cd food_butler_flutter
flutter analyze
```

### Run Tests

```bash
cd food_butler_server
dart test

cd food_butler_flutter
flutter test
```

## API Endpoints

| Endpoint | Description |
|----------|-------------|
| `askButler.discover()` | Natural language restaurant discovery |
| `curatedMaps.generateMap()` | Create AI-curated restaurant maps |
| `curatedMaps.getUserMaps()` | Get user's personal maps |
| `threeForTonight.getThreeForTonight()` | Weather-aware dinner picks |
| `dailyStory.getDailyStory()` | Get daily restaurant narrative |
| `savedRestaurant.*` | Save/unsave/list bookmarked restaurants |

## Screenshots

*Coming soon*

## Roadmap

See [agent-os/product/roadmap.md](agent-os/product/roadmap.md) for the full product roadmap.

### Current Phase: Foundation

- [x] Core app structure
- [x] Ask the Butler AI concierge
- [x] Curated Maps generation
- [x] Three for Tonight recommendations
- [x] Daily Story narratives
- [x] Save/Bookmark restaurants
- [ ] OpenTable reservation integration
- [ ] Documentary Mode (audio narration)
- [ ] Culinary DNA profiling

## Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit changes (`git commit -m 'Add amazing feature'`)
4. Push to branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

Private - All Rights Reserved

## Acknowledgments

- [Serverpod](https://serverpod.dev) - Full-stack Dart framework
- [Perplexity AI](https://perplexity.ai) - AI-powered research
- [Eater](https://eater.com) - Design inspiration
